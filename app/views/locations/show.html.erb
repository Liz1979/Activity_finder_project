<% provide(:title, "Show a location") %>

<h1>location</h1>

<p><%= @location.name %></p>
<p><%= @location.country %></p>
<p><%= @location.longitude %></p>
<p><%= @location.latitude %></p>
<p><%= @location.address %></p>

Nearby Attractions:</br>

<% @location.attractions.each do |att| %>
  <%= att.name %></br>
<% end %>


Map View:
<div style='width: 800px;'>
  <div id="map" style='width: 800px; height: 400px;'></div>
</div>


<script>
handler = Gmaps.build('Google');
handler.buildMap({ provider: {}, internal: {id: 'map'}}, function(){
  var circles = handler.addCircles(
  [{ lat: <%= @location.latitude %>, lng: <%= @location.longitude %>, radius: 5*1600 }],
  { strokeColor: '#FF0000', fillColor: '#888888'}
);
  markers = handler.addMarkers([
    {
      "lat": <%= @location.latitude %>,
      "lng": <%= @location.longitude %>
    },
    <% @location.attractions.each do |att| %>
    {
      "lat": <%= att.latitude %>,
      "lng": <%= att.longitude %>
    },
    <% end %>
  ]);
  handler.bounds.extendWith(markers);
  handler.bounds.extendWith(circles);
  handler.fitMapToBounds();
});
</script>
<%= link_to 'Back', locations_path %>
<%= link_to 'Edit', edit_location_path(@location) %>
